---
title: Diff
description: Diff
layout: PreviewAndImplementation
---

## !demo

Show inserted and deleted lines.

<Demo name="diff" />

## !implementation

Similar to the [mark annotation](/docs/code/mark), wrap the line, and style the wrapper based on the annotation.

```tsx diff.tsx -c
import { AnnotationHandler, InnerLine } from "codehike/code"
// !fold[/className="(.*?)"/gm]

const styles = {
  ins: { borderColor: "#3fb9504d", background: "#2ea04326", icon: "+" },
  del: { borderColor: "#f851494d", background: "#f8514926", icon: "-" },
  none: { borderColor: "transparent" },
} as any

export const diff: AnnotationHandler = {
  name: "diff",
  onlyIfAnnotated: true,
  Line: ({ annotation, ...props }) => {
    const query = annotation?.query || "none"
    const { background, borderColor, icon } = styles[query]
    return (
      <div className="table-row" style={{ background }}>
        <div
          className="min-w-[1ch] box-content !opacity-80 pl-2 select-none table-cell border-l-2"
          style={{ borderColor }}
        >
          {icon}
        </div>
        <div className="table-cell px-2">
          <InnerLine merge={props} />
        </div>
      </div>
    )
  },
}
```

Then pass the `diff` handler to the `Pre` component:

```tsx code.tsx -c
import { diff } from "./diff"

async function Code({ codeblock }: { codeblock: RawCode }) {
  const highlighted = await highlight(codeblock, "github-dark")
  return <Pre code={highlighted} handlers={[diff]} />
}
```
